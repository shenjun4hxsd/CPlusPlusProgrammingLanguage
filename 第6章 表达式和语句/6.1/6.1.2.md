##è¾“å…¥å‡½æ•°

&emsp;&emsp;è¯»è¾“å…¥çš„éƒ¨åˆ†é€šå¸¸éƒ½æ˜¯ç¨‹åºé‡Œæœ€éº»çƒ¦çš„éƒ¨åˆ†ï¼Œè¿™æ˜¯å› ä¸ºç¨‹åºå¿…é¡»ä¸äººäº¤æµï¼Œå®ƒå¿…é¡»å¤„ç†äººä»¬çš„å¥‡æ€æ€ªæƒ³ã€å„ç§ä¹ æƒ¯å’Œçœ‹èµ·æ¥åƒæ˜¯éšæœºçš„é”™è¯¯ã€‚è¯•å›¾å¼ºæ±‚äººæŒ‰ç…§æŸç§æ›´é€‚åˆæœºå™¨çš„æ–¹å¼æ´»åŠ¨é€šå¸¸è¢«ï¼ˆæ­£ç¡®åœ°ï¼‰è®¤ä¸ºæ˜¯å¾ˆä»¤äººè®¨åŒçš„ã€‚ä½çº§è¾“å…¥ä¾‹ç¨‹çš„å·¥ä½œæ˜¯è¯»å…¥å­—ç¬¦ï¼Œå¹¶ç”±å®ƒä»¬ç»„åˆå‡ºé«˜çº§çš„å•è¯ï¼Œè¿™äº›å•è¯éšä¹‹æˆä¸ºé«˜çº§ä¾‹ç¨‹çš„è¾“å…¥å•ä½ã€‚åœ¨è¿™é‡Œçš„ä½çº§è¾“å…¥ç”±get_token()å®Œæˆã€‚å†™ä½çº§è¾“å…¥ä¾‹ç¨‹å¹¶ä¸æ˜¯æ¯å¤©éƒ½è¦åšçš„å·¥ä½œï¼Œè®¸å¤šç³»ç»Ÿä¸­æä¾›äº†å®Œæˆè¿™äº›äº‹æƒ…çš„æ ‡å‡†å‡½æ•°ã€‚

&emsp;&emsp;æˆ‘å°†åˆ†ä¸¤ä¸ªé˜¶æ®µå®Œæˆget_token()ã€‚é¦–å…ˆæˆ‘å°†æä¾›ä¸€ä¸ªä¸å¤ªé å¾—ä½çš„ç®€å•ç‰ˆæœ¬ï¼Œå®ƒç»™ç”¨æˆ·å¼ºåŠ äº†å¾ˆå¤§è´Ÿæ‹…ã€‚è€Œåï¼Œæˆ‘è¦æŠŠå®ƒå†³å®šéœ€è¦å»ç»„åˆçš„å“ªç§å•è¯ï¼Œè€Œåè¿”å›è¡¨ç¤ºè¢«è¯»å•è¯çš„Token_valueå€¼ã€‚

&emsp;&emsp;åˆå§‹åŒ–è¯­å¥å°†ç¬¬ä¸€ä¸ªéç©ºç™½å­—ç¬¦è¯»å…¥chï¼Œå¹¶æ£€æŸ¥è¯¥è¯»å…¥æ“ä½œçš„æˆåŠŸå®Œæˆï¼š

```javascript
    Token_value get_token()
    {
        char ch = 0;
        cin >> ch;
        
        switch(ch)
        case 0:
            return curr_tok = END;        // èµ‹å€¼å’Œè¿”å›
    }
```

æŒ‰é»˜è®¤æ–¹å¼ï¼Œè¿ç®—ç¬¦ >> å°†è·³è¿‡ç©ºç™½ï¼ˆå³ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ç­‰ï¼‰ï¼Œå¦‚æœæ“ä½œå¤±è´¥è¿˜å°†ä¿æŒchä¸å˜ã€‚å› æ­¤ï¼Œch==0çš„æƒ…å†µå°±è¡¨ç¤ºäº†è¾“å…¥çš„ç»“æŸã€‚

&emsp;&emsp;èµ‹å€¼ä¹Ÿæ˜¯ä¸€ä¸ªè¿ç®—ç¬¦ï¼Œèµ‹å€¼è¡¨è¾¾å¼çš„ç»“æœå°±æ˜¯èµ‹ç»™å˜é‡é‚£ä¸ªå€¼ã€‚è¿™ä½¿æˆ‘èƒ½åœ¨åŒä¸€ä¸ªè¯­å¥é‡Œå°†å€¼ENDèµ‹ç»™curr_tokï¼Œå¹¶ä¸”è¿”å›å®ƒã€‚åœ¨ä¸€ä¸ªè¯­å¥ä¸­åšä¸¤ä»¶äº‹å¯¹äºç»´æŠ¤å¾ˆæœ‰å¸®åŠ©ã€‚å¦‚æœèµ‹å€¼å’Œè¿”å›åœ¨ä»£ç ä¸­åˆ†å¼€åšï¼Œç¨‹åºå‘˜å°±å¯èƒ½ä¼šä¿®æ”¹äº†ä¸€ä¸ªè€Œå¿˜è®°å¦ä¸€ä¸ªã€‚

&emsp;&emsp;åœ¨è€ƒè™‘æ•´ä¸ªå‡½æ•°ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆåˆ†å¼€æ¥çœ‹ä¸€äº›æƒ…å†µã€‚è¡¨è¾¾å¼ç»“æŸç¬¦';'ï¼Œæ‹¬å·å’Œè¿ç®—ç¬¦çš„å¤„ç†éƒ½å¾ˆç®€å•ï¼Œåªéœ€è¦è¿”å›å®ƒä»¬çš„å€¼ï¼š

```javascript
    case ';':
    caes '*':
    case '/':
    case '+':
    case '-':
    case '(':
    case ')':
    case '=':
        return curr_tok = Token_value(ch);
```

æ•°å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼å¤„ç†ï¼š

```javascript
    case '0': case '1': case '2': case '3': case '4:'
    case '5': case '6': case '7': case '8': case '9':
    case '.':
        cin.putback(ch);
        cin >> number_value;
        return curr_tok = NUMBER;
```

æŒ‰æ°´å¹³æ–¹å¼å°†caseæ ‡å·å †åœ¨ä¸€èµ·è€Œä¸æ˜¯å‚ç›´åœ°æ”¾ç½®å¹¶ä¸æ˜¯ä»€ä¹ˆå¥½ä¸»æ„ï¼Œå› ä¸ºè¿™ç§å®‰æ’æ›´éš¾é˜…è¯»ã€‚ç„¶è€Œï¼Œåœ¨æ¯è¡Œä¸­æ”¾ä¸€ä¸ªæ•°å­—ä¹Ÿå¾ˆä»¤äººç”ŸåŒã€‚ç”±äºè¿ç®—ç¬¦ >> å·²ç»æœ‰é’ˆå¯¹å°†æµ®ç‚¹å¸¸æ•°è¯»å…¥doubleçš„å®šä¹‰ï¼Œè¿™é‡Œçš„ä»£ç å°±éå¸¸ç®€å•ï¼šé¦–å…ˆæŠŠç¬¬ä¸€ä¸ªå­—ç¬¦ï¼ˆæ•°å­—æˆ–è€…åœ†ç‚¹ï¼‰æ”¾å›cinï¼Œè€Œåå°†å¸¸æ•°è¯»åˆ°number_valueé‡Œã€‚

&emsp;&emsp;åå­—çš„å¤„ç†ä¹Ÿä¸æ­¤ç±»ä¼¼ï¼š

```javascript
    default:            // NAME, NAME =, æˆ–è€…é”™è¯¯
        if(isalpha(ch))
        {
            cin.putback(ch);
            cin >> string_value;
            return curr_tok = NAME;
        }
        error("bad_token");
        return curr_tok = PRINT;
```

è¿™é‡Œç”¨äº†æ ‡å‡†åº“å‡½æ•°isalpha()ï¼ˆ20.4.2èŠ‚ï¼‰ï¼Œä»¥é¿å…å°†æ¯ä¸ªå­—æ¯åˆ—ä¸ºä¸€ä¸ªcaseæ ‡å·ã€‚è¿ç®—ç¬¦ >> ç”¨äºå­—ç¬¦ä¸²ï¼ˆè¿™é‡Œæ˜¯string_valueï¼‰çš„ç»“æœæ˜¯ä¸æ–­è¯»å…¥å­—ç¬¦ï¼Œç›´åˆ°é‡åˆ°ç©ºç™½ä¸ºæ­¢ã€‚è¿™æ ·ï¼Œç”¨æˆ·è¦æƒ³æŠŠæŸä¸ªåå­—ä½œä¸ºè¿ç®—ç¬¦çš„è¿ç®—å¯¹è±¡ï¼Œå°±å¿…é¡»ç”¨ç©ºç™½è¡¨ç¤ºåå­—çš„ç»“æŸã€‚è¿™ä¸€æƒ…å†µå½“ç„¶ä¸å¤ªç†æƒ³ï¼Œæˆ‘ä»¬å°†6.1.3èŠ‚é‡æ–°å›åˆ°è¿™ä¸ªé—®é¢˜ã€‚

è¿™é‡Œæ˜¯æœ€åçš„å®Œæ•´çš„è¾“å…¥å‡½æ•°ï¼š

```javascript
    Token_value get_token()
    {
        char ch = 0;
        cin >> cin;
        switch(ch)
        {
        case 0:
            return curr_tok = END;
        case ';':
        case '*':
        case '/':
        case '+':
        case '-':
        case '(':
        case ')':
        case '=':
            return curr_tok = Token_value(ch);
        case '0': case '1': case '2': case '3': case '4':
        case '5': case '6': case '7': case '8': case '9':
        case '.':
            cin.putback(ch);
            cin >> number_value;
            return curr_tok = NUMBER;
        default:                // NAME, NAME=, æˆ–è€…é”™è¯¯
            if(isalpha(ch))
            {
                cin.putback(ch);
                cin >> string_value;
                return curr_tok = NAME;
            }
            error("bad token");
            return curr_tok = PRINT;
        }
    }
```

ç”±äºå‰é¢å°†è¿ç®—ç¬¦çš„Token_valueå€¼å®šä¹‰æˆè¯¥è¿ç®—ç¬¦çš„æ•´æ•°å€¼ï¼ˆ4.8èŠ‚ï¼‰ï¼Œä»è¿ç®—ç¬¦åˆ°å¯¹åº”çš„å•è¯å€¼çš„è½¬æ¢å°±éå¸¸ç®€å•äº†ã€‚


ğŸ”š




